[[PageOutline]]

= Developer related material =

'''API is not yet stabilized. Expect some changes to happen. Yes, documentation is not very good at the moment.'''

=== Technologies used ===

 * Core
   * SQLAlchemy
   * !BeautifulSoup
   * !FeedParser
   * Python-Requests
   * !PyNzb
   * Jinja2
   * !PyYaml
   * Some smaller misc libraries
 * WebUI
   * Flask
   * Jinja2
   * Cherrypy

=== Resources ===

 * [http://doc.flexget.com Generated Sphinx API documents] 
  * This is where we will add all technical documentation in the future - see especially core section!
 * [wiki:Developers/Mock how to use mock data via configuration file]
 * [wiki:Developers/TDD test driven development how to]
 * [http://coverage.flexget.com unit test coverage]
 * [wiki:Subversion subversion] and [wiki:WhySvn why we use Subversion?]
 * [http://techspot.zzzeek.org/2012/02/07/patterns-implemented-by-sqlalchemy/ Good overview of SQLAlchemy concepts]

=== Resources, autogenerated from wiki ===

[[ListTagged(developers)]]

== Contributing ==

Making custom plugins should be easy for anyone with some python experience.

If you're working on good re-usable plugin I'd be more than happy to include it in official distribution. [wiki:Contact] for subversion write permissions or fork on [https://github.com/Flexget/Flexget github] and send pull request.

= Plugins =

Plugins are registered by calling {{{register_plugin}}} method.

{{{
register_plugin(<class name>, '<keyword>', [parameters])
}}}

You can also pass some optional named arguments

{{{
Optional arguments:
    builtin     - set to True if plugin should be executed always
    group       - group name this plugin belongs to
    groups      - list of group names this plugin belongs to
}}}

Example:
{{{
register_plugin(FilterRegexp, 'regexp')
}}}

== Phase methods ==

Listed in order of execution.

 * on_feed_start(self, feed)
 * on_feed_input(self, feed)
 * on_feed_metainfo(self, feed)
 * on_feed_filter(self, feed)
 * on_feed_download(self, feed)
 * on_feed_modify(self, feed)
 * on_feed_output(self, feed)
 * on_feed_exit(self, feed)

When multiple plugins of same phase type are enabled for a feed, the priority decorator can be used to define execution order. Default is 128. Larger number, higher priority. e.g.

{{{
@priority(120)
on_feed_filter(self, feed):
    pass
}}}

=== Feed execution UML ===

Only most important phases shown.

{{{
#!SequenceDiagram
participant Feed
participant Input
participant Filter
participant Download
participant Output

Feed->Input: Execute Input(s)
Input->Feed: Add entries
Feed->Feed: Purge Rejected, Failed
Feed->Filter: Execute Filter(s)
Filter->Feed: Reject entries
Filter->Feed: Accept entries
Feed->Feed: Purge Rejected, Failed
Feed->Download: Execute Download(s)
Feed->Feed: Purge Rejected, Failed
Feed->Output: Execute Output(s)
}}}

=== Other phases ===

 * on_feed_abort(self, feed)

=== Application phases ===

 * on_process_start(self, feed)
 * on_process_end(self, feed)

These are triggered on startup and shutdown, not between feeds.

=== Registering custom phases ===

Plugins may create new feed phases, signature is `on_feed_<name>(self, feed, ....)` (parameters depend on api version).

=== Adding commandline parameters ===

You can also add more commandline parameters. Check existing plugins. See [http://optik.sourceforge.net/ Optik homepage] for documentation.

== Unit testing ==

!FlexGet has over 200 unit tests so changes are that if your modifications pass the tests nothing major has been broken. We also have CI at [http://hudson.flexget.com].

=== Run tests ===

{{{
bin/paver test
}}}

Argument {{{--online}}} can be used to enable online tests

=== Run a single test ===

{{{
# NOTE: don't use the pathname for the file, e.g. tests/test_file.py
bin/nosetests test_file
}}}

== Running IPython inside !FlexGet ==

First install IPython

{{{
bin/easy_install ipython
}}}

And then place this where you wish to hack:

{{{
import IPython; IPython.embed()
}}}

For older 0.10 IPython this works ..

{{{
from IPython.Shell import IPShellEmbed
ipshell = IPShellEmbed([])
ipshell()
}}}